# Syntax:
# This file is read in order; later entries that match a package win.

# Each "policy" stanza can contain a number of settings and a set of
# matches that determine what packages the policy applies to.
# All conditions in a match must be met. A match can check for
# appearance of an e-mail address in either the
# "Uploader" or "Maintainer" fields of a source package.

# Default behaviour
policy {
  # Possible values: skip, build_only, push, propose, attempt_push

  # For the moment, don't create merge requests by default.
  suite {
    name: "lintian-fixes"
    mode: build_only
    command: "lintian-brush"
  }

  # Don't propose merges for upstream merges for now, since the janitor only
  # proposes changes to the main branch, not to pristine-tar/upstream.
  # See https://salsa.debian.org/jelmer/debian-janitor/issues/18
  suite {
    name: "fresh-releases"
    mode: build_only
    command: "new-upstream"
  }

  suite {
    name: "fresh-snapshots"
    mode: build_only
    command: "new-upstream --snapshot"
  }

  suite {
    name: "unchanged"
    mode: build_only
    command: "juist-build"
  }

  # Possible changelog types: auto, update_changelog, leave_changelog
#
  # Auto means that the changelog will be updated by default, unless
  # some indicator is found that gbp-dch is used with the package
  # (e.g. a [dch] section in debian/gbp.conf)
  changelog: auto
}

# Beta testers, automatically receiving merge proposals for lintian-fixes.
policy {
  match { maintainer: "jelmer@debian.org" }
  match { maintainer: "pkg-bazaar-maint@lists.alioth.debian.org" }
  match { maintainer: "pkg-go-maintainers@lists.alioth.debian.org" }
  match { maintainer: "python-modules-team@lists.alioth.debian.org" }
  match { maintainer: "debian-science-maintainers@lists.alioth.debian.org" }
  match { maintainer: "debian-med-packaging@lists.alioth.debian.org" }
  match { maintainer: "pkg-javascript-devel@lists.alioth.debian.org" }
  match { maintainer: "xnox@debian.org" }
  match { maintainer: "xnox@ubuntu.com" }
  match { maintainer: "dmitrij.ledkov@ubuntu.com" }
  match { maintainer: "wilmer@gaast.net" }
  match { maintainer: "zeha@debian.org" }
  match { maintainer: "wouter@debian.org" }
  match { maintainer: "odyx@debian.org" }
  match { maintainer: "skarp@amazon.com" }
  match { uploader: "jelmer@debian.org" }
  match { uploader: "aragilar@gmail.com" }
  match { uploader: "dkg@fifthhorseman.net" }
  match { maintainer: "dkg@fifthhorseman.net" }
  match { maintainer: "hartmans@debian.org" }
  match { maintainer: "micha@debian.org" }
  match { maintainer: "stuart@debian.org" }
  match { uploader: "stuart@debian.org" }
  match { maintainer: "mattia@debian.org" }
  match { uploader: "mattia@debian.org" }
  match { maintainer: "mattia@debian.org" }
  match { maintainer: "debian-x@lists.debian.org" }
  match { maintainer: "debian-hams@lists.debian.org" }

  suite {
    name: "lintian-fixes"
    mode: propose
  }
}

# Gradually adding everybody, with slowstart.
policy {
  match { maintainer: "*@debian.org" }
  match { maintainer: "*@lists.alioth.debian.org" }

  suite {
    name: "lintian-fixes"
    mode: propose
  }
}

# Don't upgrade PostgreSQL team packages beyond oldoldstable.
policy {
  match { maintainer: "team+postgresql@tracker.debian.org" }

  suite {
    name: "lintian-fixes"
    mode: propose
    command: "lintian-brush --compat-release=oldoldstable"
  }
}

# DebianGIS packages are backported to Ubuntu LTS by the Ubuntu GIS project.
policy {
  match { maintainer: "pkg-grass-devel@lists.alioth.debian.org" }

  # Oldest supported LTS on Ubuntu.
  suite {
    name: "lintian-fixes"
    command: "lintian-brush --compat-release=xenial"
    mode: propose
  }
}

# RaphaÃ«l prefers merge proposals without changelog updates.
policy {
  match { maintainer: "hertzog@debian.org" }
  match { uploader: "hertzog@debian.org" }
  changelog: leave_changelog
}

# The GNUstep maintainers don't like debhelper-compat.
policy {
  match { maintainer: "pkg-gnustep-maintainers@lists.alioth.debian.org" }

  suite {
    name: "lintian-fixes"
    command: "lintian-brush --exclude=uses-debhelper-compat-file"
  }
}

# For packages that are maintained by the QA team, attempt to push
# but fall back to proposing changes.
policy {
  match { maintainer: "packages@qa.debian.org" }
  suite {
    name: "lintian-fixes"
    mode: attempt_push
  }
}

# Requires contributor agreement
policy {
  match { source_package: "zeroc-ice" }
  match { source_package: "ice-builder-gradle" }
  match { source_package: "cronutils" }
  match { source_package: "xsecurelock" }
  match { source_package: "nsscache" }
  match { source_package: "libnss-cache" }

  suite {
    name: "lintian-fixes"
    mode: skip
  }
}
